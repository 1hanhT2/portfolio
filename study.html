<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Study Workspace • Bui Tan Thanh</title>
    <link rel="icon" type="image/svg+xml" href="./resources/favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Montserrat:wght@700;800&display=swap" rel="stylesheet">
    <style>
        /* --- Base / tokens from main portfolio --- */
        :root {
            --bg: #0b0d12;
            --surface: #11161d;
            --surface-2: #0f141a;
            --text: #e5ecf5;
            --muted: #9fb0c3;
            --line: #263243;
            --accent: #7c5cff;
            --accent-2: #00d4ff;
            --ok: #3ae374;
            --warn: #f5a524;
            --danger: #ff5470;
            --radius: 16px;
            --shadow: 0 10px 30px rgba(0, 0, 0, .35), 0 4px 8px rgba(0, 0, 0, .25);
        }

        *, *::before, *::after { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            margin: 0;
            font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
            color: var(--text);
            background: var(--bg);
            line-height: 1.6;
            letter-spacing: 0.2px;
            overflow-x: hidden;
        }
        h1, h2, h3 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
        }
        a { color: inherit; text-decoration: none; }

        /* --- Background Effects --- */
        .bg-wrap {
            position: fixed; inset: 0; z-index: -2; pointer-events: none; overflow: hidden;
            background: radial-gradient(1200px 700px at 10% -10%, rgba(124, 92, 255, .35), transparent 60%), radial-gradient(900px 600px at 85% 20%, rgba(0, 212, 255, .25), transparent 60%), radial-gradient(900px 700px at 50% 110%, rgba(255, 84, 112, .18), transparent 60%);
            filter: saturate(110%);
        }
        .bg-wrap::before {
            content: ""; position: absolute; inset: 0;
            background-image: radial-gradient(1px 1px at 15px 25px, white, transparent), radial-gradient(1px 1px at 75px 95px, white, transparent), radial-gradient(1px 1px at 135px 165px, white, transparent), radial-gradient(1px 1px at 45px 125px, white, transparent), radial-gradient(1px 1px at 185px 55px, white, transparent);
            background-size: 200px 200px; opacity: 0.3;
        }
        .stars { position: absolute; inset: -10vh -10vw; background: transparent; }
        .stars::before, .stars::after { content: ""; position: absolute; inset: 0; background-repeat: repeat; background-size: 300px 300px; opacity: .35; }
        .stars::before { background-image: radial-gradient(1px 1px at 20px 30px, #bbd1ff 50%, transparent 51%), radial-gradient(1px 1px at 140px 180px, #9bc9ff 50%, transparent 51%), radial-gradient(1px 1px at 240px 80px, #d6e2ff 50%, transparent 51%); }
        .stars::after { background-image: radial-gradient(1px 1px at 70px 60px, #cde0ff 50%, transparent 51%), radial-gradient(1px 1px at 200px 200px, #c3d9ff 50%, transparent 51%); opacity: .2; }

        /* --- Layout & Nav --- */
        .shell { width: min(1160px, 92vw); margin-inline: auto; }
        .nav {
            position: sticky; top: 14px; z-index: 50; display: flex; align-items: center; justify-content: space-between;
            gap: 12px; padding: 10px 14px; border-radius: 999px; backdrop-filter: blur(10px);
            background: color-mix(in oklab, var(--surface) 88%, transparent); box-shadow: var(--shadow);
            border: 1px solid color-mix(in oklab, var(--line) 80%, transparent); margin-bottom: 40px;
        }
        .brand { display: flex; align-items: center; gap: 10px; font-weight: 700; }
        .brand-dots { display: inline-flex; gap: 4px; }
        .brand-dots span { width: 8px; height: 8px; border-radius: 999px; display: block; background: linear-gradient(135deg, var(--accent), var(--accent-2)); filter: drop-shadow(0 0 6px rgba(124, 92, 255, .6)); }
        .nav-links { display: flex; align-items: center; gap: 8px; }
        .nav a { padding: 8px 12px; border-radius: 10px; color: var(--muted); }
        .nav a:hover { color: var(--text); background: linear-gradient(135deg, rgba(124, 92, 255, .12), rgba(0, 212, 255, .12)); }
        
        /* --- Buttons & Cards --- */
        .btn {
            display: inline-flex; align-items: center; justify-content: center; gap: 8px; padding: 10px 14px;
            border-radius: 12px; font-weight: 600; border: 1px solid transparent;
            background: linear-gradient(var(--surface), var(--surface)) padding-box, linear-gradient(135deg, var(--accent), var(--accent-2)) border-box;
            color: var(--text);
            box-shadow: inset 0 -1px 0 rgba(255, 255, 255, .05), 0 6px 18px rgba(124, 92, 255, .25);
            transition: transform .2s ease, box-shadow .2s ease, background-color .2s ease;
        }
        .btn:hover { transform: translateY(-1px); box-shadow: inset 0 -1px 0 rgba(255, 255, 255, .06), 0 10px 26px rgba(124, 92, 255, .33); }
        .btn.secondary { background: linear-gradient(var(--surface), var(--surface)) padding-box, linear-gradient(135deg, #304055, #2b3240) border-box; }
        
        .card {
            position: relative;
            background: color-mix(in oklab, var(--surface) 90%, transparent);
            border: 1px solid var(--line); border-radius: var(--radius); padding: 24px; box-shadow: var(--shadow);
        }

        /* --- Study Workspace App Styles --- */
        .app-container {
            max-width: 600px;
            margin: 80px auto; /* Increased vertical margin */
            text-align: center;
        }
        #clock {
            font-family: 'Montserrat', sans-serif;
            color: var(--text);
            font-size: clamp(3rem, 10vw, 4.5rem);
            font-weight: 700;
            padding: 20px 40px;
            border-radius: 999px;
            background-color: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            cursor: pointer;
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: transform .3s ease, box-shadow .3s ease;
        }
        #clock:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
        }
        #date {
            font-size: 0.3em;
            font-weight: 500;
            color: var(--muted);
            letter-spacing: .5px;
            margin-top: 5px;
        }
        #notepad {
            background-color: var(--surface-2);
            padding: 20px;
            border-radius: var(--radius);
            margin-top: 25px; /* Added space between clock and notepad */
            border: 1px solid var(--line);
            text-align: left;
            display: none;
            max-height: 60vh;
            overflow-y: auto;
        }
        #notepad.active {
            display: block;
            animation: slideIn .5s ease forwards;
        }
        @keyframes slideIn {
            from { transform: translateY(-10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .task {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 10px;
            background-color: var(--surface);
            position: relative;
        }
        .task:hover .delete-btn { display: flex; }
        .task-checkboxes { display: flex; gap: 8px; }
        .task input[type="checkbox"] {
            appearance: none; -webkit-appearance: none;
            width: 18px; height: 18px;
            border-radius: 6px;
            cursor: pointer;
            transition: all .2s ease;
            position: relative;
        }
        .task input.tracking-checkbox { border: 2px solid var(--accent); }
        .task input.tracking-checkbox:checked { background-color: var(--accent); }
        .task input.completed-checkbox { border: 2px solid var(--ok); }
        .task input.completed-checkbox:checked { background-color: var(--ok); }
        .task input[type="checkbox"]:checked::before {
            content: '✔';
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            color: var(--surface);
            font-size: 12px;
            font-weight: bold;
        }
        .task label {
            flex-grow: 1;
            margin: 0 12px;
            padding: 2px 5px;
            border: 1px solid transparent;
        }
        .task label[contenteditable="true"]:focus {
            outline: none;
            border-color: var(--accent-2);
            background-color: var(--surface-2);
            border-radius: 4px;
        }
        .delete-btn {
            cursor: pointer; color: var(--muted); background: none; border: none;
            width: 24px; height: 24px; align-items: center; justify-content: center;
            border-radius: 50%; display: none; transition: background-color .2s ease, color .2s ease;
        }
        .delete-btn:hover { background-color: var(--danger); color: var(--text); }
        #add-task-btn { margin-top: 15px; width: 100%; }

        /* --- Footer & Cursor --- */
        .footer { color: var(--muted); padding: 40px 0 70px; text-align: center; }
        .cursor-blob { position: fixed; top: 0; left: 0; width: 260px; height: 260px; border-radius: 50%; pointer-events: none; z-index: -1; background: radial-gradient(closest-side, rgba(124, 92, 255, .22), rgba(0, 212, 255, .12), transparent 60%); filter: blur(30px); transform: translate(-50%, -50%); mix-blend-mode: screen; opacity: .7; }
        @media (max-width: 900px), (pointer: coarse) { .cursor-blob { display: none; } }

    </style>
</head>
<body>
    <div class="bg-wrap" aria-hidden="true">
        <div class="stars"></div>
    </div>
    <div class="cursor-blob" id="blob" aria-hidden="true"></div>

    <main class="shell">
        <nav class="nav">
            <a class="brand" href="index.html">
                <span class="brand-dots"><span></span><span></span><span></span><span></span></span>
                <span>Bui Tan Thanh</span>
            </a>
            <div class="nav-links">
                <a href="index.html#journey">Journey</a>
                <a href="index.html#achievements">Achievements</a>
                <a href="index.html#features">Features</a>
                <a href="index.html">Back to Main</a>
                <a class="btn" href="index.html#contact">Get in touch</a>
            </div>
        </nav>

        <div class="app-container">
            <div id="clock">
                <div id="time"></div>
                <div id="date"></div>
            </div>
            <div id="notepad" class="card">
                <!-- Tasks will be added here -->
                <button id="add-task-btn" class="btn secondary">Add Task</button>
            </div>
        </div>

        <footer class="footer">© <span id="year"></span> Bui Tan Thanh</footer>
    </main>

    <script>
        // --- Year & Cursor Blob ---
        document.getElementById('year').textContent = new Date().getFullYear();
        const blobEl = document.getElementById('blob');
        let bx = window.innerWidth / 2, by = window.innerHeight / 2;
        window.addEventListener('pointermove', (e) => { bx = e.clientX; by = e.clientY; }, { passive: true });
        const tick = () => {
            const curX = parseFloat(blobEl.style.left || bx), curY = parseFloat(blobEl.style.top || by);
            blobEl.style.left = (curX + (bx - curX) * 0.12) + 'px';
            blobEl.style.top  = (curY + (by - curY) * 0.12) + 'px';
            requestAnimationFrame(tick);
        };
        tick();

        // --- Study Workspace App Logic ---
        function updateClock() {
            const now = new Date();
            document.getElementById('time').textContent = now.toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit' });
            document.getElementById('date').textContent = now.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        }

        function addTask(taskText = 'New Task', isTrackingChecked = false, isCompletedChecked = false, elapsedTime = 0) {
            const notepad = document.getElementById('notepad');
            const newTaskDiv = document.createElement('div');
            newTaskDiv.className = 'task';

            const checkboxContainer = document.createElement('div');
            checkboxContainer.className = 'task-checkboxes';

            const trackingCheckbox = document.createElement('input');
            trackingCheckbox.type = 'checkbox';
            trackingCheckbox.className = 'tracking-checkbox';
            trackingCheckbox.checked = isTrackingChecked;

            const completedCheckbox = document.createElement('input');
            completedCheckbox.type = 'checkbox';
            completedCheckbox.className = 'completed-checkbox';
            completedCheckbox.checked = isCompletedChecked;
            completedCheckbox.addEventListener('change', saveTasks);

            checkboxContainer.appendChild(trackingCheckbox);
            checkboxContainer.appendChild(completedCheckbox);
            
            const newLabel = document.createElement('label');
            newLabel.setAttribute('contenteditable', 'true');
            newLabel.textContent = taskText;
            newLabel.addEventListener('input', saveTasks);
            
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'delete-btn';
            deleteBtn.innerHTML = '&#x2715;'; // X character
            deleteBtn.setAttribute('aria-label', 'Delete task');
            deleteBtn.addEventListener('click', (event) => {
                event.stopPropagation();
                newTaskDiv.remove();
                saveTasks();
            });

            const timerSpan = document.createElement('span');
            timerSpan.className = 'task-timer';
            timerSpan.textContent = formatElapsedTime(elapsedTime);

            newTaskDiv.append(checkboxContainer, newLabel, timerSpan, deleteBtn);
            
            trackingCheckbox.addEventListener('change', () => {
                if (trackingCheckbox.checked) {
                    timerSpan.dataset.startTime = Date.now() - elapsedTime;
                    timerSpan.dataset.intervalId = setInterval(() => {
                        const elapsed = Date.now() - parseInt(timerSpan.dataset.startTime, 10);
                        timerSpan.textContent = formatElapsedTime(elapsed);
                    }, 1000);
                } else {
                    clearInterval(timerSpan.dataset.intervalId);
                    elapsedTime = Date.now() - parseInt(timerSpan.dataset.startTime, 10);
                    timerSpan.textContent = formatElapsedTime(elapsedTime);
                }
                saveTasks();
            });

            if (isTrackingChecked) {
                trackingCheckbox.dispatchEvent(new Event('change'));
            }

            notepad.insertBefore(newTaskDiv, document.getElementById('add-task-btn'));
            if (taskText === 'New Task') newLabel.focus();
        }

        function formatElapsedTime(milliseconds) {
            if (!milliseconds) return '00:00:00';
            const totalSeconds = Math.floor(milliseconds / 1000);
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function saveTasks() {
            const tasks = [];
            document.querySelectorAll('.task').forEach(taskDiv => {
                const trackingCheckbox = taskDiv.querySelector('.tracking-checkbox');
                const completedCheckbox = taskDiv.querySelector('.completed-checkbox');
                const label = taskDiv.querySelector('label');
                const timer = taskDiv.querySelector('.task-timer');
                let elapsedTime = 0;
                
                if (timer.dataset.startTime) {
                    elapsedTime = Date.now() - parseInt(timer.dataset.startTime, 10);
                    if (!trackingCheckbox.checked) {
                       // If not checked, we need to get the final stored value, not a running one
                       // This requires a slight refactor in how elapsedTime is stored. For now, this is an approximation.
                       // A better way would be to store final elapsedTime on the element when paused.
                       // Let's parse the text content for a stable value on paused timers.
                       const timeParts = timer.textContent.split(':');
                       elapsedTime = (parseInt(timeParts[0])*3600 + parseInt(timeParts[1])*60 + parseInt(timeParts[2])) * 1000;
                    }
                }
                
                tasks.push({
                    text: label.textContent,
                    trackingChecked: trackingCheckbox.checked,
                    completedChecked: completedCheckbox.checked,
                    elapsedTime: elapsedTime
                });
            });
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        function loadTasks() {
            const savedTasks = localStorage.getItem('tasks');
            if (savedTasks) {
                const tasks = JSON.parse(savedTasks);
                tasks.forEach(task => addTask(task.text, task.trackingChecked, task.completedChecked, task.elapsedTime));
            }
        }

        document.getElementById('add-task-btn').addEventListener('click', () => {
            addTask();
            saveTasks();
        });

        document.getElementById('clock').addEventListener('click', () => {
            document.getElementById('notepad').classList.toggle('active');
        });

        updateClock();
        setInterval(updateClock, 1000);
        loadTasks();

    </script>
</body>
</html>

